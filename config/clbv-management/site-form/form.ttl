@prefix form: <http://lblod.data.gift/vocabularies/forms/>.
@prefix sh: <http://www.w3.org/ns/shacl#>.
@prefix mu: <http://mu.semte.ch/vocabularies/core/>.
@prefix fieldGroups: <http://data.lblod.info/field-groups/>.
@prefix fields: <http://data.lblod.info/fields/>.
@prefix displayTypes: <http://lblod.data.gift/display-types/>.
@prefix ext: <http://mu.semte.ch/vocabularies/ext/>.
@prefix schema: <http://schema.org/>.
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix foaf: <http://xmlns.com/foaf/0.1/>.

ext:formDefinition a form:Form, form:TopLevelForm;
    form:includes ext:siteType;
    form:includes ext:primaryAddress;
    form:includes ext:contactpointsL.

ext:corePropertyGroup a form:PropertyGroup;
    sh:description "Parent property group, used to group fields and property groups together";
    sh:name "Kerngevens";
    sh:order 2.

# Type vestiging
ext:siteType a form:Field;
    sh:name "Type vestiging";
    sh:order 3;
    sh:path <http://data.lblod.info/vocabularies/erediensten/vestigingstype>;
    form:options """{"conceptScheme":"http://clbv-form-management-service/concept-schemes/sitetypes","searchEnabled":false}""";
    form:displayType displayTypes:conceptSchemeSelector;
    form:validations [
        a form:RequiredConstraint;
        form:grouping form:Bag;
        sh:path <http://data.lblod.info/vocabularies/erediensten/vestigingstype>;
        sh:resultMessage "Gelieve een type vestiging te kiezen."
    ];
    sh:group ext:corePropertyGroup.

ext:primaryAddress a form:Field;
    sh:name "Gaat het om het primair correspondentieadres?";
    sh:order 4;
    sh:path [ <http://www.w3.org/ns/org#siteAddress> <http://schema.org/contactType> ];
    form:options """{"conceptScheme":"http://data.lblod.info/conceptschemes/ContactTypes","searchEnabled":false}""";
    form:displayType displayTypes:conceptSchemeRadioButtons;
    sh:group ext:corePropertyGroup.

ext:contactPropertyGroup a form:PropertyGroup;
    sh:description "Parent property group, used to group fields and property groups together";
    sh:name "Contactgegevens";
    sh:order 700.

##########################################################
#  listing-scope: Contactpunten
##########################################################
ext:contactpointsS a form:Scope;
  sh:path <http://www.w3.org/ns/org#siteAddress>.

##########################################################
#  Listing: Contactpunten
##########################################################
ext:contactpointsL a form:Listing;
  form:each ext:contactpointsSf;
  form:scope ext:contactpointsS;
  form:createGenerator ext:contactpointsG;
  sh:group ext:contactPropertyGroup;
  form:addLabel "Voeg contactpunt toe";
  form:canAdd false;
  form:canRemove false;
  sh:maxCount 1;
  sh:minCount 1;
  sh:order 1 .


##########################################################
#  Subform: Contactpunten
##########################################################
ext:contactpointsSf a form:SubForm;
   form:removeLabel "Verwijder contactpunt";
   form:includes ext:contactPEmailF;
   form:includes ext:contactPTelephoneF;
   form:includes ext:contactPageF.
   # form:includes ext:contactPOpeningF;
   # form:includes ext:contactPointAddressL.

##########################################################
# Field: ContactPunt email
##########################################################
ext:contactPEmailF a form:Field ;
    sh:name "Email" ;
    sh:order 1 ;
    form:validations [
      a form:ValidEmail ;
      form:grouping form:MatchEvery ;
      sh:path schema:email ;
      sh:resultMessage "Geef een geldig e-mailadres op."@nl
    ] ;
    sh:path schema:email ;
    form:displayType displayTypes:defaultInput ;
    sh:group ext:contactPropertyGroup .

##########################################################
# Field: ContactPunt phone
##########################################################
ext:contactPTelephoneF a form:Field ;
    sh:name "Telefoon" ;
    sh:order 2 ;
    form:validations [
      a form:ValidPhoneNumber ;
      form:grouping form:MatchEvery ;
      form:defaultCountry "BE" ;
      sh:path schema:telephone ;
      sh:resultMessage "Geef een geldig telefoonnummer in."@nl
    ] ;
    sh:path schema:telephone ;
    form:displayType displayTypes:defaultInput ;
    sh:group ext:contactPropertyGroup .

##########################################################
# Field: ContactPunt website
##########################################################
ext:contactPageF a form:Field ;
    sh:name "Website URL" ;
    sh:order 3 ;
    form:validations [
      a form:UriConstraint ;
      form:grouping form:MatchEvery ;
      sh:resultMessage "Gelieve een geldige URL op te geven. Zorg dat vooraan in de link altijd http://, https://, ftp:// of sftp:// staat."; # TODO: later custom validator
      sh:path foaf:page
    ];
    sh:path foaf:page ;
    form:displayType displayTypes:defaultInput ;
    sh:group ext:contactPropertyGroup .
